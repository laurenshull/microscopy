close all;

% ANIMAL 1
[A1mat1, A1doub1, A1red1, A1green1, A1thresh1] = ...
getHeterogeneity('1 BF_an1.tif','1 RED_an1.tif','1 GFP_an1.tif');
[A1mat2, A1doub2, A1red2, A1green2, A1thresh2] = ...
getHeterogeneity('2 BF_an1.tif','2 RED_an1.tif','2 GFP_an1.tif');
[A1mat3, A1doub3, A1red3, A1green3, A1thresh3] = ...
getHeterogeneity('3 BF_an1.tif','3 RED_an1.tif','3 GFP_an1.tif');
[A1mat4, A1doub4, A1red4, A1green4, A1thresh4] = ...
getHeterogeneity('4 BF_an1.tif','4 RED_an1.tif','4 GFP_an1.tif');
[A1mat5, A1doub5, A1red5, A1green5, A1thresh5] = ...
getHeterogeneity('5 BF_an1.tif','5 RED_an1.tif','5 GFP_an1.tif');

thresh1 = [A1thresh1, A1thresh2, A1thresh3, A1thresh4, A1thresh5, ...
    mean([A1thresh1, A1thresh2, A1thresh3, A1thresh4, A1thresh5])];
totalA1Mat = vertcat(A1mat1, A1mat2, A1mat3, A1mat4, A1mat5);
totalA1Doub = A1doub1 + A1doub2 + A1doub3 + A1doub4 + A1doub5;
totalA1Red = A1red1 + A1red2 + A1red3 + A1red4 + A1red5;
totalA1Green = A1green1 + A1green2 + A1green3 + A1green4 + A1green5;
N1 = totalA1Doub + totalA1Red + totalA1Green;
percentDoubPos1 = totalA1Doub/(totalA1Red+totalA1Doub);

% ANIMAL 2
[A2mat1, A2doub1, A2red1, A2green1, A2thresh1] = ...
getHeterogeneity('1 BF_an2.tif','1 RED_an2.tif','1 GFP_an2.tif');
[A2mat2, A2doub2, A2red2, A2green2, A2thresh2] = ...
getHeterogeneity('2 BF_an2.tif','2 RED_an2.tif','2 GFP_an2.tif');
[A2mat3, A2doub3, A2red3, A2green3, A2thresh3] = ...
getHeterogeneity('3 BF_an2.tif','3 RED_an2.tif','3 GFP_an2.tif');
[A2mat4, A2doub4, A2red4, A2green4, A2thresh4] = ...
getHeterogeneity('4 BF_an2.tif','4 RED_an2.tif','4 GFP_an2.tif');
[A2mat5, A2doub5, A2red5, A2green5, A2thresh5] = ...
getHeterogeneity('5 BF_an2.tif','5 RED_an2.tif','5 GFP_an2.tif');
[A2mat6, A2doub6, A2red6, A2green6, A2thresh6] = ...
getHeterogeneity('6 BF_an2.tif','6 RED_an2.tif','6 GFP_an2.tif');

thresh2 = [A2thresh1, A2thresh2, A2thresh3, A2thresh4, A2thresh5,...
    A2thresh6 ...
    mean([A2thresh1, A2thresh2, A2thresh3, A2thresh4, A2thresh5,...
    A2thresh6])];
totalA2Mat = vertcat(A2mat1, A2mat2, A2mat3, A2mat4, A2mat5, A2mat6);
totalA2Doub = A2doub1 + A2doub2 + A2doub3 + A2doub4 + A2doub5 + A2doub6;
totalA2Red = A2red1 + A2red2 + A2red3 + A2red4 + A2red5 + A2red6;
totalA2Green = A2green1 + A2green2 + A2green3 + A2green4 + A2green5...
    + A2green6;
N2 = totalA2Doub + totalA2Red + totalA2Green;
percentDoubPos2 = totalA2Doub/(totalA2Red+totalA2Doub);

% ANIMAL 4
[A4mat1, A4doub1, A4red1, A4green1, A4thresh1] = ...
getHeterogeneity('1 BF_an4.tif','1 RED_an4.tif','1 GFP_an4.tif');
[A4mat2, A4doub2, A4red2, A4green2, A4thresh2] = ...
getHeterogeneity('2 BF_an4.tif','2 RED_an4.tif','2 GFP_an4.tif');
[A4mat3, A4doub3, A4red3, A4green3, A4thresh3] = ...
getHeterogeneity('3 BF_an4.tif','3 RED_an4.tif','3 GFP_an4.tif');
[A4mat4, A4doub4, A4red4, A4green4, A4thresh4] = ...
getHeterogeneity('4 BF_an4.tif','4 RED_an4.tif','4 GFP_an4.tif');
[A4mat5, A4doub5, A4red5, A4green5, A4thresh5] = ...
getHeterogeneity('5 BF_an4.tif','5 RED_an4.tif','5 GFP_an4.tif');
[A4mat6, A4doub6, A4red6, A4green6, A4thresh6] = ...
getHeterogeneity('6 BF_an4.tif','6 RED_an4.tif','6 GFP_an4.tif');

thresh4 = [A4thresh1, A4thresh2, A4thresh3, A4thresh4, A4thresh5,...
    A4thresh6 ...
    mean([A4thresh1, A4thresh2, A4thresh3, A4thresh4, A4thresh5,...
    A4thresh6])];
totalA4Mat = vertcat(A4mat1, A4mat2, A4mat3, A4mat4, A4mat5, A4mat6);
totalA4Doub = A4doub1 + A4doub2 + A4doub3 + A4doub4 + A4doub5 + A4doub6;
totalA4Red = A4red1 + A4red2 + A4red3 + A4red4 + A4red5 + A4red6;
totalA4Green = A4green1 + A4green2 + A4green3 + A4green4 + A4green5...
    + A4green6;
N4 = totalA4Doub + totalA4Red + totalA4Green;
percentDoubPos4 = totalA4Doub/(totalA4Red+totalA4Doub);

% ANIMAL 5
[A5mat1, A5doub1, A5red1, A5green1, A5thresh1] = ...
getHeterogeneity('1 BF_an5.tif','1 RED_an5.tif','1 GFP_an5.tif');
[A5mat2, A5doub2, A5red2, A5green2, A5thresh2] = ...
getHeterogeneity('2 BF_an5.tif','2 RED_an5.tif','2 GFP_an5.tif');
[A5mat3, A5doub3, A5red3, A5green3, A5thresh3] = ...
getHeterogeneity('3 BF_an5.tif','3 RED_an5.tif','3 GFP_an5.tif');
[A5mat4, A5doub4, A5red4, A5green4, A5thresh4] = ...
getHeterogeneity('4 BF_an5.tif','4 RED_an5.tif','4 GFP_an5.tif');
[A5mat5, A5doub5, A5red5, A5green5, A5thresh5] = ...
getHeterogeneity('5 BF_an5.tif','5 RED_an5.tif','5 GFP_an5.tif');
[A5mat6, A5doub6, A5red6, A5green6, A5thresh6] = ...
getHeterogeneity('6 BF_an5.tif','6 RED_an5.tif','6 GFP_an5.tif');

thresh5 = [A5thresh1, A5thresh2, A5thresh3, A5thresh4, A5thresh5,...
    A5thresh6...
    mean([A5thresh1, A5thresh2, A5thresh3, A5thresh4, A5thresh5,...
    A5thresh6])];
totalA5Mat = vertcat(A5mat1, A5mat2, A5mat3, A5mat4, A5mat5, A5mat6);
totalA5Doub = A5doub1 + A5doub2 + A5doub3 + A5doub4 + A5doub5 + A5doub6;
totalA5Red = A5red1 + A5red2 + A5red3 + A5red4 + A5red5 + A5red6;
totalA5Green = A5green1 + A5green2 + A5green3 + A5green4 + A5green5...
    + A5green6;
N5 = totalA5Doub + totalA5Red + totalA5Green;
percentDoubPos5 = totalA5Doub/(totalA5Red+totalA5Doub);

% ANIMAL 6
[A6mat1, A6doub1, A6red1, A6green1, A6thresh1] = ...
getHeterogeneity('1 BF_an6.tif','1 RED_an6.tif','1 GFP_an6.tif');
[A6mat2, A6doub2, A6red2, A6green2, A6thresh2] = ...
getHeterogeneity('2 BF_an6.tif','2 RED_an6.tif','2 GFP_an6.tif');
[A6mat3, A6doub3, A6red3, A6green3, A6thresh3] = ...
getHeterogeneity('3 BF_an6.tif','3 RED_an6.tif','3 GFP_an6.tif');
[A6mat4, A6doub4, A6red4, A6green4, A6thresh4] = ...
getHeterogeneity('4 BF_an6.tif','4 RED_an6.tif','4 GFP_an6.tif');
[A6mat5, A6doub5, A6red5, A6green5, A6thresh5] = ...
getHeterogeneity('5 BF_an6.tif','5 RED_an6.tif','5 GFP_an6.tif');
[A6mat6, A6doub6, A6red6, A6green6, A6thresh6] = ...
getHeterogeneity('6 BF_an6.tif','6 RED_an6.tif','6 GFP_an6.tif');
[A6mat7, A6doub7, A6red7, A6green7, A6thresh7] = ...
getHeterogeneity('7 BF_an6.tif','7 RED_an6.tif','7 GFP_an6.tif');
[A6mat8, A6doub8, A6red8, A6green8, A6thresh8] = ...
getHeterogeneity('8 BF_an6.tif','8 RED_an6.tif','8 GFP_an6.tif');

thresh6 = [A6thresh1, A6thresh2, A6thresh3, A6thresh4, A6thresh5,...
    A6thresh6, A6thresh7, A6thresh8 ...
    mean([A6thresh1, A6thresh2, A6thresh3, A6thresh4, A6thresh5,...
    A6thresh6, A6thresh7, A6thresh8])];
totalA6Mat = vertcat(A6mat1, A6mat2, A6mat3, A6mat4, A6mat5,...
    A6mat6, A6mat7, A6mat8);
totalA6Doub = A6doub1 + A6doub2 + A6doub3 + A6doub4 + A6doub5...
    + A6doub6 + A6doub7 + A6doub8;
totalA6Red = A6red1 + A6red2 + A6red3 + A6red4 + A6red5 + A6red6...
    + A6red7 + A6red8;
totalA6Green = A6green1 + A6green2 + A6green3 + A6green4 + A6green5...
    + A6green6 + A6green7 + A6green8;
N6 = totalA6Doub + totalA6Red + totalA6Green;
percentDoubPos6 = totalA6Doub/(totalA6Red+totalA6Doub);

% ANIMAL 7
[A7mat1, A7doub1, A7red1, A7green1, A7thresh1] = ...
getHeterogeneity('1 BF_an7.tif','1 RED_an7.tif','1 GFP_an7.tif');
[A7mat2, A7doub2, A7red2, A7green2, A7thresh2] = ...
getHeterogeneity('2 BF_an7.tif','2 RED_an7.tif','2 GFP_an7.tif');
[A7mat3, A7doub3, A7red3, A7green3, A7thresh3] = ...
getHeterogeneity('3 BF_an7.tif','3 RED_an7.tif','3 GFP_an7.tif');
[A7mat4, A7doub4, A7red4, A7green4, A7thresh4] = ...
getHeterogeneity('4 BF_an7.tif','4 RED_an7.tif','4 GFP_an7.tif');
[A7mat5, A7doub5, A7red5, A7green5, A7thresh5] = ...
getHeterogeneity('5 BF_an7.tif','5 RED_an7.tif','5 GFP_an7.tif');

thresh7 = [A7thresh1, A7thresh2, A7thresh3, A7thresh4, A7thresh5 ...
    mean([A7thresh1, A7thresh2, A7thresh3, A7thresh4, A7thresh5])];
totalA7Mat = vertcat(A7mat1, A7mat2, A7mat3, A7mat4, A7mat5);
totalA7Doub = A7doub1 + A7doub2 + A7doub3 + A7doub4 + A7doub5;
totalA7Red = A7red1 + A7red2 + A7red3 + A7red4 + A7red5;
totalA7Green = A7green1 + A7green2 + A7green3 + A7green4 + A7green5;
N7 = totalA7Doub + totalA7Red + totalA7Green;
percentDoubPos7 = totalA7Doub/(totalA7Red+totalA7Doub);

% ANIMAL 8
[A8mat1, A8doub1, A8red1, A8green1, A8thresh1] = ...
getHeterogeneity('1 BF_an8.tif','1 RED_an8.tif','1 GFP_an8.tif');
[A8mat2, A8doub2, A8red2, A8green2, A8thresh2] = ...
getHeterogeneity('2 BF_an8.tif','2 RED_an8.tif','2 GFP_an8.tif');
[A8mat3, A8doub3, A8red3, A8green3, A8thresh3] = ...
getHeterogeneity('3 BF_an8.tif','3 RED_an8.tif','3 GFP_an8.tif');
[A8mat4, A8doub4, A8red4, A8green4, A8thresh4] = ...
getHeterogeneity('4 BF_an8.tif','4 RED_an8.tif','4 GFP_an8.tif');

thresh8 = [A8thresh1, A8thresh2, A8thresh3, A8thresh4, ...
    mean([A8thresh1, A8thresh2, A8thresh3, A8thresh4])];
totalA8Mat = vertcat(A8mat1, A8mat2, A8mat3, A8mat4);
totalA8Doub = A8doub1 + A8doub2 + A8doub3 + A8doub4;
totalA8Red = A8red1 + A8red2 + A8red3 + A8red4;
totalA8Green = A8green1 + A8green2 + A8green3 + A8green4;
N8 = totalA8Doub + totalA8Red + totalA8Green;
percentDoubPos8 = totalA8Doub/(totalA8Red+totalA8Doub);